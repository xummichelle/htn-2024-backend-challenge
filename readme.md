# Hack the North 2023 Backend Challenge Submission

A REST API server using Python and Flask for working with hackathon participant data. Would have loved to dockerize the application, ran out of time! However, I'm glad to practice some complex SQL statements and learn the basics of Flask and PostgresQL! Let me know if there are any issues trying out my application, I would be happy to demo how the API works. :)

## Environment
OS: Ubuntu

DB: PostgreSQL

Backend: Python 3.10.12 and Flask

## Install requirements
1. Clone the project and set up virtual environment.

```
python -m venv venv
```

 2. Then install the required python packages:


```
pip install -r requirements.txt
```

**OR** directly install packages:
```
pip install psycopg2
pip install flask
```

## Set up and connect to database

Using the psql tool, first, create the table:
```
CREATE TABLE users (
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    data jsonb
);
```
Each user will be assigned an id from 1-1000. 

Then insert the json data into the ```users``` table. (I saved the sample data at the path ```/home/ubuntu/htn_data.json```.)

```\set content `cat /home/ubuntu/htn_data.json``` to set the content variable first, then type the following:

```
with json_array as (select jsonb_array_elements(:'content'::jsonb) as properties)
insert into users(data) select * from json_array;
```
Finally fill in the database connection info in the .env file.

## Usage

Run the application:
```
flask --app app/app.py run
```
or
```
python3 app/app.py
```

Then you can start getting data from the server.

### Example curl commands:

#### Get all users:

```curl http://localhost:3000/users/```

Returns a list of all user data in the database in json format.

#### Get information for one user:

```curl http://localhost:3000/users/123```

Returns the json user data for a specific user.

#### Update user information:

```curl -X PUT -H "Content-Type: application/json" -d '{"skills": [{"skill": "Swift", "rating": 1}]}' http://localhost:3000/users/1```

Updates the skills list of the user with id=1 to include Swift with a rating of 4.

```curl -X PUT -H "Content-Type: application/json" -d '{"phone": "+1 (555) 123 4567"}' http://localhost:3000/users/1```

Updates the "phone" field of the user with id=1 to "+1 (555) 123 4567"

#### Get aggregate info of skills

```curl http:localhost:3000/skills/?min_frequency=1\&max_frequency=40```

Returns a list of skills where the number of users for each skill is between min_frequency=1 and max_frequency=40.

The response returned looks like:
```
[
    {
        "skill": <string>, 
        "count": <integer>
    }, 
    {
        ...
    }
]
```

